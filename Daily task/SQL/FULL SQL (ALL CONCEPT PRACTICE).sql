CREATE DATABASE XYZ_COMPANY ;
USE XYZ_COMPANY;
CREATE TABLE EMPLOYEE 
(
 SR INT PRIMARY KEY ,
 NAME VARCHAR(30) ,
 SALARY INT 
);
INSERT INTO EMPLOYEE 
(SR,NAME,SALARY)
VALUES
(1,"ADAM",25000),
(2,"BOB",30000),
(3,"CASEY",40000);
SELECT * FROM EMPLOYEE ;










CREATE DATABASE COLLAGE;
USE COLLAGE;
CREATE TABLE STUDENT
(
	ROLLNO INT PRIMARY KEY ,
    NAME VARCHAR(30) ,
    MARKS INT NOT NULL ,
    GRADE VARCHAR(1),
    CITY VARCHAR(30)
);
INSERT INTO STUDENT (ROLLNO , NAME , MARKS , GRADE , CITY )
VALUES 
(101,"ANIL",78,"C","PUNE"),
(102,"BHUMIKA",93,"A","MUMBAI"),
(103,"CHETAN",85,"B","MUMBAI"),
(104,"DHRUV",96,"A","DELHI"),
(105,"EMANUEL",12,"F","DELHI"),
(106,"FARAH",82,"B","DELHI");
SELECT * FROM STUDENT;
SELECT NAME , MARKS FROM STUDENT ;
SELECT CITY FROM STUDENT ;
SELECT DISTINCT CITY FROM STUDENT ;
SELECT * FROM STUDENT WHERE MARKS > 80 ;
SELECT * FROM STUDENT WHERE CITY = "MUMBAI" ;
SELECT * FROM STUDENT WHERE MARKS > 80 AND CITY = "MUMBAI" ;
SELECT * FROM STUDENT WHERE MARKS + 10 > 100 ;
SELECT * FROM STUDENT WHERE MARKS = 93 ;
SELECT * FROM STUDENT WHERE MARKS > 90 AND CITY = "MUMBAI" ;
SELECT * FROM STUDENT WHERE MARKS > 90 OR CITY = "MUMBAI" ;
SELECT * FROM STUDENT WHERE MARKS BETWEEN 80 AND 90  ;
SELECT * FROM STUDENT WHERE CITY IN ( "DELHI","MUMBAI" );
SELECT * FROM STUDENT WHERE CITY IN ( "DELHI", "AHMEDABAD" "MUMBAI" );
SELECT * FROM STUDENT WHERE CITY NOT IN ( "DELHI","MUMBAI" );
SELECT * FROM STUDENT WHERE MARKS > 75  LIMIT 3 ;
SELECT * FROM STUDENT ORDER BY CITY ASC ;
SELECT * FROM STUDENT ORDER BY MARKS ASC ;
SELECT * FROM STUDENT ORDER BY MARKS DESC LIMIT 3 ;
SELECT MARKS FROM STUDENT ;
SELECT MAX(MARKS) FROM STUDENT ;
SELECT MIN(MARKS) FROM STUDENT ;
SELECT AVG(MARKS) FROM STUDENT ;
SELECT COUNT(ROLLNO) FROM STUDENT ;

SELECT CITY  
FROM STUDENT 
GROUP BY CITY ;


SELECT CITY , COUNT(ROLLNO) 
FROM STUDENT 
GROUP BY CITY ;

SELECT CITY , NAME , COUNT(ROLLNO) 
FROM STUDENT 
GROUP BY CITY , NAME ;

SELECT CITY , AVG(MARKS) 
FROM STUDENT 
GROUP BY CITY ORDER BY CITY ;

SELECT CITY , AVG(MARKS) 
FROM STUDENT 
GROUP BY CITY ORDER BY AVG(MARKS) ;

SELECT GRADE 
FROM STUDENT 
GROUP BY GRADE 
ORDER BY GRADE ;

SELECT GRADE , COUNT(ROLLNO)
FROM STUDENT 
GROUP BY GRADE 
ORDER BY GRADE ;

SELECT CITY , COUNT(NAME) 
FROM STUDENT 
GROUP BY CITY ;

SELECT CITY , COUNT(NAME) 
FROM STUDENT 
GROUP BY CITY 
HAVING MAX(MARKS) > 90 ;

SET SQL_SAFE_UPDATES = 0 ;

UPDATE STUDENT 
SET GRADE = "O"
WHERE GRADE = "A" ;

SELECT * FROM STUDENT ;

UPDATE STUDENT 
SET MARKS = 82
WHERE ROLLNO = 105 ;

SELECT * FROM STUDENT ;

UPDATE STUDENT 
SET GRADE = "A"
WHERE MARKS BETWEEN 80 AND 90 ;

SELECT * FROM STUDENT ;

UPDATE STUDENT 
SET MARKS  = MARKS + 1 ;

SELECT * FROM STUDENT ;

UPDATE STUDENT 
SET MARKS = 12 
WHERE ROLLNO = 105 ;

SELECT * FROM STUDENT ;

DELETE FROM STUDENT 
WHERE MARKS < 33 ;
SELECT * FROM STUDENT ;

CREATE TABLE DEPT
(
	ID INT PRIMARY KEY ,
    NAME VARCHAR(50)
);

INSERT INTO DEPT
VALUES
(101,"ENGLISH"),
(102,"IT");

SELECT * FROM DEPT ;

UPDATE DEPT 
SET ID = 111 
WHERE ID = 101 ;

CREATE TABLE TEACHER
(
	ID INT PRIMARY KEY ,
    NAME VARCHAR(50) ,
    DEPT_ID INT ,
    FOREIGN KEY (DEPT_ID) REFERENCES DEPT(ID)
    ON UPDATE CASCADE
    ON DELETE CASCADE
);

DROP TABLE TEACHER ;

CREATE TABLE TEACHER
(
	ID INT PRIMARY KEY ,
    NAME VARCHAR(50) ,
    DEPT_ID INT ,
    FOREIGN KEY (DEPT_ID) REFERENCES DEPT(ID)
    ON UPDATE CASCADE
    ON DELETE CASCADE
);

INSERT INTO TEACHER 
VALUES 
(101 , "ADAM" , 101),
(102 , "EVE" , 102);

SELECT * FROM TEACHER ;

CREATE DATABASE COLLAGE;
USE COLLAGE;
CREATE TABLE STUDENT
(
	ROLLNO INT PRIMARY KEY ,
    NAME VARCHAR(30) ,
    MARKS INT NOT NULL ,
    GRADE VARCHAR(1),
    CITY VARCHAR(30)
);
INSERT INTO STUDENT (ROLLNO , NAME , MARKS , GRADE , CITY )
VALUES 
(101,"ANIL",78,"C","PUNE"),
(102,"BHUMIKA",93,"A","MUMBAI"),
(103,"CHETAN",85,"B","MUMBAI"),
(104,"DHRUV",96,"A","DELHI"),
(105,"EMANUEL",12,"F","DELHI"),
(106,"FARAH",82,"B","DELHI");
SELECT * FROM STUDENT;
SELECT NAME , MARKS FROM STUDENT ;
SELECT CITY FROM STUDENT ;
SELECT DISTINCT CITY FROM STUDENT ;
SELECT * FROM STUDENT WHERE MARKS > 80 ;
SELECT * FROM STUDENT WHERE CITY = "MUMBAI" ;
SELECT * FROM STUDENT WHERE MARKS > 80 AND CITY = "MUMBAI" ;
SELECT * FROM STUDENT WHERE MARKS + 10 > 100 ;
SELECT * FROM STUDENT WHERE MARKS = 93 ;
SELECT * FROM STUDENT WHERE MARKS > 90 AND CITY = "MUMBAI" ;
SELECT * FROM STUDENT WHERE MARKS > 90 OR CITY = "MUMBAI" ;
SELECT * FROM STUDENT WHERE MARKS BETWEEN 80 AND 90  ;
SELECT * FROM STUDENT WHERE CITY IN ( "DELHI","MUMBAI" );
SELECT * FROM STUDENT WHERE CITY IN ( "DELHI", "AHMEDABAD" "MUMBAI" );
SELECT * FROM STUDENT WHERE CITY NOT IN ( "DELHI","MUMBAI" );
SELECT * FROM STUDENT WHERE MARKS > 75  LIMIT 3 ;
SELECT * FROM STUDENT ORDER BY CITY ASC ;
SELECT * FROM STUDENT ORDER BY MARKS ASC ;
SELECT * FROM STUDENT ORDER BY MARKS DESC LIMIT 3 ;
SELECT MARKS FROM STUDENT ;
SELECT MAX(MARKS) FROM STUDENT ;
SELECT MIN(MARKS) FROM STUDENT ;
SELECT AVG(MARKS) FROM STUDENT ;
SELECT COUNT(ROLLNO) FROM STUDENT ;

SELECT CITY  
FROM STUDENT 
GROUP BY CITY ;


SELECT CITY , COUNT(ROLLNO) 
FROM STUDENT 
GROUP BY CITY ;

SELECT CITY , NAME , COUNT(ROLLNO) 
FROM STUDENT 
GROUP BY CITY , NAME ;

SELECT CITY , AVG(MARKS) 
FROM STUDENT 
GROUP BY CITY ORDER BY CITY ;

SELECT CITY , AVG(MARKS) 
FROM STUDENT 
GROUP BY CITY ORDER BY AVG(MARKS) ;

SELECT GRADE 
FROM STUDENT 
GROUP BY GRADE 
ORDER BY GRADE ;

SELECT GRADE , COUNT(ROLLNO)
FROM STUDENT 
GROUP BY GRADE 
ORDER BY GRADE ;

SELECT CITY , COUNT(NAME) 
FROM STUDENT 
GROUP BY CITY ;

SELECT CITY , COUNT(NAME) 
FROM STUDENT 
GROUP BY CITY 
HAVING MAX(MARKS) > 90 ;

SET SQL_SAFE_UPDATES = 0 ;

UPDATE STUDENT 
SET GRADE = "O"
WHERE GRADE = "A" ;

SELECT * FROM STUDENT ;

UPDATE STUDENT 
SET MARKS = 82
WHERE ROLLNO = 105 ;

SELECT * FROM STUDENT ;

UPDATE STUDENT 
SET GRADE = "A"
WHERE MARKS BETWEEN 80 AND 90 ;

SELECT * FROM STUDENT ;

UPDATE STUDENT 
SET MARKS  = MARKS + 1 ;

SELECT * FROM STUDENT ;

UPDATE STUDENT 
SET MARKS = 12 
WHERE ROLLNO = 105 ;

SELECT * FROM STUDENT ;

DELETE FROM STUDENT 
WHERE MARKS < 33 ;
SELECT * FROM STUDENT ;

ALTER TABLE STUDENT 
ADD COLUMN AGE INT ;

SELECT * FROM STUDENT ;

ALTER TABLE STUDENT 
DROP COLUMN AGE  ;

SELECT * FROM STUDENT ;

ALTER TABLE STUDENT 
ADD COLUMN AGE INT NOT NULL DEFAULT 19 ;

SELECT * FROM STUDENT ;

ALTER TABLE STUDENT 
MODIFY COLUMN AGE VARCHAR(2) ;

INSERT INTO STUDENT
(ROLLNO , NAME , MARKS , AGE )
VALUES 
(107,"GARGI", 68 , 100);

ALTER TABLE STUDENT
CHANGE AGE STU_AGE INT ;

SELECT * FROM STUDENT ;

INSERT INTO STUDENT
(ROLLNO , NAME , MARKS , STU_AGE )
VALUES 
(107,"GARGI", 68 , 100);

SELECT * FROM STUDENT ;

ALTER TABLE STUDENT 
DROP COLUMN STU_AGE ;

SELECT * FROM STUDENT ;

ALTER TABLE STUDENT 
RENAME TO STU ;

SELECT * FROM STU ;

ALTER TABLE STU 
RENAME TO STUDENT ;

SELECT * FROM STUDENT ;

TRUNCATE TABLE STUDENT ;

SELECT * FROM STUDENT ;

INSERT INTO STUDENT (ROLLNO , NAME , MARKS , GRADE , CITY )
VALUES 
(101,"ANIL",78,"C","PUNE"),
(102,"BHUMIKA",93,"A","MUMBAI"),
(103,"CHETAN",85,"B","MUMBAI"),
(104,"DHRUV",96,"A","DELHI"),
(105,"EMANUEL",12,"F","DELHI"),
(106,"FARAH",82,"B","DELHI");

SELECT * FROM STUDENT ;

ALTER TABLE STUDENT 
CHANGE NAME FULL_NAME VARCHAR(50) ;

SELECT * FROM STUDENT ;

DELETE FROM STUDENT 
WHERE MARKS < 80  ;

SELECT * FROM STUDENT ;

ALTER TABLE STUDENT 
DROP COLUMN GRADE ;

SELECT * FROM STUDENT ;



CREATE DATABASE COLLAGE1 ;
USE COLLAGE1;
CREATE TABLE STUDENT1 
(
 ID INT PRIMARY KEY ,
 NAME VARCHAR(30) 
);
INSERT INTO STUDENT1 
(ID,NAME)
VALUES
(101,"ADAM"),
(102,"BOB"),
(103,"CASEY");
SELECT * FROM STUDENT1 ;

CREATE TABLE COURSE1 
(
 ID INT PRIMARY KEY ,
 COURSE VARCHAR(30) 
);
INSERT INTO COURSE1
(ID,COURSE)
VALUES
(1012,"ENGLISH"),
(105,"MATH"),
(103,"SCIENCE"),
(107,"COMPUTER SCIENCE");

UPDATE COURSE1
SET ID = 102 
WHERE ID = 1012 ;

SELECT * FROM STUDENT1 ;
SELECT * FROM COURSE1 ;

SELECT * 
FROM STUDENT1 
INNER JOIN COURSE1 
ON STUDENT1.ID = COURSE1.ID ; 

SELECT * 
FROM STUDENT1 AS S
INNER JOIN COURSE1 AS C
ON S.ID = C.ID ; 

SELECT *
FROM STUDENT1 AS S 
LEFT JOIN COURSE1 AS C 
ON S.ID = C. ID ; 

SELECT *
FROM STUDENT1 AS A 
RIGHT  JOIN COURSE1 AS B 
ON A.ID = B. ID ; 

SELECT * FROM STUDENT1 AS A 
LEFT JOIN COURSE1 AS B 
ON A.ID = B. ID 
UNION
SELECT * FROM STUDENT1 AS A 
RIGHT  JOIN COURSE1 AS B 
ON A.ID = B. ID ; 


SELECT * FROM STUDENT1 AS A 
LEFT JOIN COURSE1 AS B 
ON A.ID = B. ID 

SELECT * FROM STUDENT1 AS A 
LEFT JOIN COURSE1 AS B 
ON A.ID = B. ID 
WHERE B.ID IS NULL;

SELECT * FROM STUDENT1 AS A 
RIGHT JOIN COURSE1 AS B 
ON A.ID = B. ID 
WHERE A.ID IS NULL;

SELECT * FROM STUDENT1 AS A 
LEFT JOIN COURSE1 AS B 
ON A.ID = B. ID 
UNION
SELECT * FROM STUDENT1 AS A 
RIGHT  JOIN COURSE1 AS B 
ON A.ID = B. ID 
WHERE A.ID != B.ID AND B.ID != A.ID;

CREATE TABLE EMPLOYEE1
(
 SR INT PRIMARY KEY ,
 NAME VARCHAR(30) ,
 MANAGER_ID INT 
);
INSERT INTO EMPLOYEE1
(SR,NAME,MANAGER_ID)
VALUES
(1,"ADAM",103),
(2,"BOB",104),
(3,"CASEY",NULL),
(4,"DONALD",103);
SELECT * FROM EMPLOYEE1 ;

UPDATE EMPLOYEE1
SET ID = 101 
WHERE ID = 1 ;

UPDATE EMPLOYEE1
SET ID = 102 
WHERE ID = 2 ;

UPDATE EMPLOYEE1
SET ID = 103 
WHERE ID = 3 ;

UPDATE EMPLOYEE1
SET ID = 104 
WHERE ID = 4 ;

ALTER TABLE EMPLOYEE1
CHANGE SR ID INT ;
SELECT * FROM EMPLOYEE1 ;

SELECT * 
FROM EMPLOYEE1 AS A 
JOIN EMPLOYEE1 AS B 
ON A.ID = B.MANAGER_ID;

SELECT A.NAME AS MANAGER_NAME , B.NAME 
FROM EMPLOYEE1 AS A 
JOIN EMPLOYEE1 AS B 
ON A.ID = B.MANAGER_ID;

SELECT NAME FROM EMPLOYEE1 
UNION
SELECT NAME FROM EMPLOYEE1;

SELECT NAME FROM EMPLOYEE1 
UNION ALL
SELECT NAME FROM EMPLOYEE1;

USE COLLAGE;
CREATE TABLE STUDENT2
(
	ROLLNO INT PRIMARY KEY ,
    NAME VARCHAR(30) ,
    MARKS INT NOT NULL ,
    GRADE VARCHAR(1),
    CITY VARCHAR(30)
);
INSERT INTO STUDENT2 (ROLLNO , NAME , MARKS , GRADE , CITY )
VALUES 
(101,"ANIL",78,"C","PUNE"),
(102,"BHUMIKA",93,"A","MUMBAI"),
(103,"CHETAN",85,"B","MUMBAI"),
(104,"DHRUV",96,"A","DELHI"),
(105,"EMANUEL",12,"F","DELHI"),
(106,"FARAH",82,"B","DELHI");
SELECT * FROM STUDENT2;

UPDATE STUDENT2 
SET MARKS = 92 
WHERE MARKS = 12 ;

SELECT AVG(MARKS)
FROM STUDENT2;

SELECT NAME 
FROM STUDENT2
WHERE MARKS>87.6667;

SELECT NAME , MARKS
FROM STUDENT2
WHERE MARKS>87.6667;

SELECT NAME , MARKS 
FROM STUDENT2
WHERE MARKS > ( SELECT AVG(MARKS) FROM STUDENT2);

SELECT ROLLNO  
FROM STUDENT2
WHERE ROLLNO % 2 = 0 ;

SELECT NAME 
FROM STUDENT2
WHERE ROLLNO IN
(102,104,106);

SELECT NAME 
FROM STUDENT2
WHERE ROLLNO IN(
	SELECT ROLLNO  
	FROM STUDENT2
	WHERE ROLLNO % 2 = 0 );
    
SELECT * 
FROM STUDENT2 
WHERE CITY = "DELHI" ;
    
SELECT MAX(MARKS) 
FROM (SELECT * FROM STUDENT2 WHERE CITY = "DELHI" ) AS TEMPORARY ;

SELECT MAX(MARKS) 
FROM (SELECT * FROM STUDENT2 WHERE CITY = "MUMBAI" ) AS TEMPORARY ;

SELECT MAX(MARKS)
FROM STUDENT2
WHERE CITY = "DELHI";

SELECT MAX(MARKS)
FROM STUDENT2
WHERE CITY = "MUMBAI";

SELECT ( SELECT MAX(MARKS) FROM STUDENT2) , NAME 
FROM STUDENT2 ;

CREATE VIEW VIEW1 AS 
SELECT ROLLNO , NAME , MARKS FROM STUDENT ;
 
SELECT * FROM VIEW1;

SELECT * FROM VIEW1
WHERE MARKS > 90 ;

DROP VIEW VIEW1 ;

SELECT * FROM VIEW1 ; 

CREATE VIEW VIEW1 AS 
SELECT ROLLNO , NAME , MARKS FROM STUDENT2 ;

SELECT * FROM VIEW1;